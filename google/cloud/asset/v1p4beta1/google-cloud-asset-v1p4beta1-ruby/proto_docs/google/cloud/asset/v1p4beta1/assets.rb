# frozen_string_literal: true

# Copyright 2022 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Auto-generated by gapic-generator-ruby. DO NOT EDIT!


module Google
  module Cloud
    module Asset
      module V1p4beta1
        # IAM Policy analysis result, consisting of one IAM policy binding and derived
        # access control lists.
        # @!attribute [rw] attached_resource_full_name
        #   @return [::String]
        #     The full name of the resource to which the {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult#iam_binding iam_binding} policy attaches.
        # @!attribute [rw] iam_binding
        #   @return [::Google::Iam::V1::Binding]
        #     The Cloud IAM policy binding under analysis.
        # @!attribute [rw] access_control_lists
        #   @return [::Array<::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::AccessControlList>]
        #     The access control lists derived from the {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult#iam_binding iam_binding} that match or
        #     potentially match resource and access selectors specified in the request.
        # @!attribute [rw] identity_list
        #   @return [::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::IdentityList]
        #     The identity list derived from members of the {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult#iam_binding iam_binding} that match or
        #     potentially match identity selector specified in the request.
        # @!attribute [rw] fully_explored
        #   @return [::Boolean]
        #     Represents whether all nodes in the transitive closure of the
        #     {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult#iam_binding iam_binding} node have been explored.
        class IamPolicyAnalysisResult
          include ::Google::Protobuf::MessageExts
          extend ::Google::Protobuf::MessageExts::ClassMethods

          # Represents analysis state of each node in the result graph or non-critical
          # errors in the response.
          # @!attribute [rw] code
          #   @return [::Google::Rpc::Code]
          #     The Google standard error code that best describes the state.
          #     For example:
          #     - OK means the node has been successfully explored;
          #     - PERMISSION_DENIED means an access denied error is encountered;
          #     - DEADLINE_EXCEEDED means the node hasn't been explored in time;
          # @!attribute [rw] cause
          #   @return [::String]
          #     The human-readable description of the cause of failure.
          class AnalysisState
            include ::Google::Protobuf::MessageExts
            extend ::Google::Protobuf::MessageExts::ClassMethods
          end

          # A GCP resource that appears in an access control list.
          # @!attribute [rw] full_resource_name
          #   @return [::String]
          #     The [full resource name](https://aip.dev/122#full-resource-names).
          # @!attribute [rw] analysis_state
          #   @return [::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::AnalysisState]
          #     The analysis state of this resource node.
          class Resource
            include ::Google::Protobuf::MessageExts
            extend ::Google::Protobuf::MessageExts::ClassMethods
          end

          # A role or permission that appears in an access control list.
          # @!attribute [rw] role
          #   @return [::String]
          #     The role.
          # @!attribute [rw] permission
          #   @return [::String]
          #     The permission.
          # @!attribute [rw] analysis_state
          #   @return [::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::AnalysisState]
          #     The analysis state of this access node.
          class Access
            include ::Google::Protobuf::MessageExts
            extend ::Google::Protobuf::MessageExts::ClassMethods
          end

          # A directional edge.
          # @!attribute [rw] source_node
          #   @return [::String]
          #     The source node of the edge.
          # @!attribute [rw] target_node
          #   @return [::String]
          #     The target node of the edge.
          class Edge
            include ::Google::Protobuf::MessageExts
            extend ::Google::Protobuf::MessageExts::ClassMethods
          end

          # An identity that appears in an access control list.
          # @!attribute [rw] name
          #   @return [::String]
          #     The identity name in any form of members appear in
          #     [IAM policy
          #     binding](https://cloud.google.com/iam/reference/rest/v1/Binding), such
          #     as:
          #     - user:foo@google.com
          #     - group:group1@google.com
          #     - serviceAccount:s1@prj1.iam.gserviceaccount.com
          #     - projectOwner:some_project_id
          #     - domain:google.com
          #     - allUsers
          #     - etc.
          # @!attribute [rw] analysis_state
          #   @return [::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::AnalysisState]
          #     The analysis state of this identity node.
          class Identity
            include ::Google::Protobuf::MessageExts
            extend ::Google::Protobuf::MessageExts::ClassMethods
          end

          # An access control list, derived from the above IAM policy binding, which
          # contains a set of resources and accesses. May include one
          # item from each set to compose an access control entry.
          #
          # NOTICE that there could be multiple access control lists for one IAM policy
          # binding. The access control lists are created based on resource and access
          # combinations.
          #
          # For example, assume we have the following cases in one IAM policy binding:
          # - Permission P1 and P2 apply to resource R1 and R2;
          # - Permission P3 applies to resource R2 and R3;
          #
          # This will result in the following access control lists:
          # - AccessControlList 1: [R1, R2], [P1, P2]
          # - AccessControlList 2: [R2, R3], [P3]
          # @!attribute [rw] resources
          #   @return [::Array<::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Resource>]
          #     The resources that match one of the following conditions:
          #     - The resource_selector, if it is specified in request;
          #     - Otherwise, resources reachable from the policy attached resource.
          # @!attribute [rw] accesses
          #   @return [::Array<::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Access>]
          #     The accesses that match one of the following conditions:
          #     - The access_selector, if it is specified in request;
          #     - Otherwise, access specifiers reachable from the policy binding's role.
          # @!attribute [rw] resource_edges
          #   @return [::Array<::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Edge>]
          #     Resource edges of the graph starting from the policy attached
          #     resource to any descendant resources. The {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Edge#source_node Edge.source_node} contains
          #     the full resource name of a parent resource and {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Edge#target_node Edge.target_node}
          #     contains the full resource name of a child resource. This field is
          #     present only if the output_resource_edges option is enabled in request.
          class AccessControlList
            include ::Google::Protobuf::MessageExts
            extend ::Google::Protobuf::MessageExts::ClassMethods
          end

          # @!attribute [rw] identities
          #   @return [::Array<::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Identity>]
          #     Only the identities that match one of the following conditions will be
          #     presented:
          #     - The identity_selector, if it is specified in request;
          #     - Otherwise, identities reachable from the policy binding's members.
          # @!attribute [rw] group_edges
          #   @return [::Array<::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Edge>]
          #     Group identity edges of the graph starting from the binding's
          #     group members to any node of the {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::IdentityList#identities identities}. The {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Edge#source_node Edge.source_node}
          #     contains a group, such as "group:parent@google.com". The
          #     {::Google::Cloud::Asset::V1p4beta1::IamPolicyAnalysisResult::Edge#target_node Edge.target_node} contains a member of the group,
          #     such as "group:child@google.com" or "user:foo@google.com".
          #     This field is present only if the output_group_edges option is enabled in
          #     request.
          class IdentityList
            include ::Google::Protobuf::MessageExts
            extend ::Google::Protobuf::MessageExts::ClassMethods
          end
        end
      end
    end
  end
end
